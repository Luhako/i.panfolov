#include <iostream>
#include <fstream>
#include <string> 
#include <map>

int main()
{
    std::ifstream chitaem("chitaiOtsuda.txt"); // файл откуда брать слова
    
    if (!chitaem) { // попытка открыть файл
        std::cout << "Unable to open file for read";
        return 1;
    }
    int all = 0;
    std::map<std::string, int> SkolkoSlov = {};
    std::string slovo;
    char bukva;
    bool etobukva = false;
    bool slovaNet = true;
    std::string vseBolBukvi = "QWERTYUIOPASDFGHJKLZXCVBNMЙЦУКЕНГШЩЗХЪФЫВАПРОЛДЖЭЯЧСМИТЬБЮ1234567890";
    std::string vseMalBukvi = "qwertyuiopasdfghjklzxcvbnmйцукенгшщзхъфывапролджэячсмитьбю1234567890";
    while (chitaem.get(bukva)) { // пока в файле что-то есть определяем буква для слова это или разделитель
        for (int i = 0; i < vseBolBukvi.length(); i++) {
            if (bukva == vseBolBukvi[i] || bukva == vseMalBukvi[i]) {
                bukva = vseMalBukvi[i];
                etobukva = true;
                break;
            }
        }
        if (etobukva) {
            etobukva = false;
            slovo += bukva;
        }
        else if (slovo!=""){
            all += 1;
            //std::cout << slovo << " ";
            slovaNet = true;
            for (auto i : SkolkoSlov) {
                if (i.first == slovo) {
                    slovaNet = false;
                    SkolkoSlov[i.first]++;
                    std::cout << i.second << " ";
                    break;
                }
            }
            if (slovaNet) {
                SkolkoSlov.insert({ slovo,1 });
            }
            slovo = "";
        }
    }
    if (slovo != "") {                   // последнее слово надо довыводить даже если после него ничего нет
        all += 1;
        //std::cout << slovo << " ";
        slovaNet = true;
        for (auto i : SkolkoSlov) {
            if (i.first == slovo) {
                slovaNet = false;
                SkolkoSlov[i.first]++;
                break;
            }
        }
        if (slovaNet) {
            SkolkoSlov.insert({slovo,1});
        }
        slovo = "";
    }

    chitaem.close(); //не забывайте закрывать файлы а-то они не открываются!!!

    std::ofstream pishem("pishiSuda.txt");
    if (!pishem) { // попытка открыть файл? нужна ли она если я пишу?
        std::cout << "Unable to open file for write";
        return 1;
    }

    int skolko = 0;
    while (!SkolkoSlov.empty()) {
        for (auto i : SkolkoSlov) {
            if (i.second > skolko) {
                slovo = i.first;
                skolko = i.second;
                std::cout << i.second;
            }
        }
        pishem << slovo << " " << skolko << " " << (skolko / double(all)) << "\n";
        SkolkoSlov.erase(slovo);
        skolko = 0;
    }

    pishem.close();
    return 0;
}
